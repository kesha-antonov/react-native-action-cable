"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const INTERNAL=require("./internal").default,Subscription=require("./subscription").default;class Subscriptions{constructor(i){this.subscriptions=[],this.create=i=>{const s="object"==typeof i?i:{channel:i},t=new Subscription(this.consumer,s);return this.add(t)},this.add=i=>(this.subscriptions.push(i),this.consumer.ensureActiveConnection(),this.notify(i,"initialized"),this.sendCommand(i,"subscribe"),i),this.remove=i=>(this.forget(i),this.findAll(i.identifier).length||this.sendCommand(i,"unsubscribe"),i),this.reject=i=>{const s=this.findAll(i);for(const i of s)this.forget(i),this.notify(i,"rejected");return s},this.forget=i=>(this.subscriptions=this.subscriptions.filter((s=>s!==i)),i),this.findAll=i=>this.subscriptions.filter((s=>s.identifier===i)),this.reload=()=>{for(const i of this.subscriptions)this.sendCommand(i,"subscribe")},this.notifyAll=(i,...s)=>{for(const t of this.subscriptions)this.notify(t,i,...s)},this.notify=(i,s,...t)=>{let e;e="string"==typeof i?this.findAll(i):[i];for(const i of e)"function"==typeof i[s]&&i[s](...t)},this.sendCommand=(i,s)=>{const{identifier:t}=i;this.consumer.send({command:s,identifier:t})},this.consumer=i}}exports.default=Subscriptions;