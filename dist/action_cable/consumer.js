"use strict";var __importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0});const connection_1=__importDefault(require("./connection")),subscriptions_1=__importDefault(require("./subscriptions"));class Consumer{constructor(e,t,n,s={}){this.send=e=>{this.connection.send(e)},this.connect=()=>{this.connection.open()},this.disconnect=()=>{this.connection.close({allowReconnect:!1})},this.ensureActiveConnection=()=>{this.connection.isActive()||this.connection.open()},this._url=e,this._headers=s,this.log=t,this.WebSocket=n,this.subscriptions=new subscriptions_1.default(this),this.connection=new connection_1.default(this,t,n)}get url(){return this.createWebSocketURL(this._url)}get headers(){return this.createHeaders(this._headers)}createWebSocketURL(e){const t="function"==typeof e?e():e;return t&&!/^wss?:/i.test(t)?t.replace("http","ws"):t}createHeaders(e){return"function"==typeof e?e():e}}exports.default=Consumer;