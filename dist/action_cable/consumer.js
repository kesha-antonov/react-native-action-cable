var Connection,Consumer,Subscriptions;Connection=require("./connection").default,Subscriptions=require("./subscriptions").default,Consumer=class{constructor(n,e,t,i={}){this.send=this.send.bind(this),this.connect=this.connect.bind(this),this.disconnect=this.disconnect.bind(this),this.ensureActiveConnection=this.ensureActiveConnection.bind(this),this.log=e,this.WebSocket=t,this.subscriptions=new Subscriptions(this),this.connection=new Connection(this,this.log,this.WebSocket),Object.defineProperty(this,"url",{get:function(){return this.createWebSocketURL(n)},configurable:!0}),Object.defineProperty(this,"headers",{get:function(){return this.createHeaders(i)},configurable:!0})}send(n){return this.connection.send(n)}connect(){return this.connection.open()}disconnect(){return this.connection.close({allowReconnect:!1})}ensureActiveConnection(){if(!this.connection.isActive())return this.connection.open()}createWebSocketURL(n){var e;return(n=null!=(e="function"==typeof n?n():void 0)?e:n)&&!/^wss?:/i.test(n)&&(n=n.replace("http","ws")),n}createHeaders(n){var e;return null!=(e="function"==typeof n?n():void 0)?e:n}};export default Consumer;